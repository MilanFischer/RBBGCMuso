#' This is the function which is capable change multiple specific lines to other using their row numbers.
#'
#' he function uses the previous changspecline function to operate.
         ##From now changespecline is in the forarcheologist file, because its no longer needed
#' 
#' @author Roland Hollos
#' @keywords internal
#' 

changemulline <- function(filePaths, calibrationPar, contents, fileOut=NULL, fileToChange, modifyOriginal=FALSE){
    selectFileToWrite <- function(filePaths, fileTochange){
        if(fileToChange == "epc"){
            return(filePaths[1])
        } else{
            return(filePaths[2])            
        }

    }

    if(modifyOriginal){
        fileOut <- filePaths
        mutated <- TRUE
    } else {
        fileOut <- sapply(filePaths, function (x){
            paste0(tools::file_path_sans_ext(basename(x)),"-tmp.",tools::file_ext(x))
        })
        mutated <- FALSE
    }
    
    if(xor(is.list(calibrationPar), is.list(contents)) ){
        stop("If you change epc and ini files also, you have to use list for calibrationPar, and paramateters.")
    }
    
    if(!is.element(fileToChange,c("ini","epc","both"))){
        stop("RBBGCMuso can only change ini or epc file, so fileToChange can be 'epc/ini/both'")
    }

    if(fileToChange == "epc" | fileToChange == "ini"){
        changeMusoC(selectFileToWrite(filePaths, fileToChange),fileOut[1], cbind(calibrationPar, contents))
    }
    
    if(fileToChange == "both"){
        changeMusoC(filePaths[1],fileOut[1], cbind(calibrationPar[[1]],contents[[1]]))
        changeMusoC(filePaths[2],fileOut[2], cbind(calibrationPar[[1]],contents[[2]]))
    }

    return(mutated)
}


